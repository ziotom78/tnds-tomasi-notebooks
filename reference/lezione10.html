
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="S2I MkDocs Example">
      
      
        <meta name="author" content="CERN Authoring">
      
      
        <link rel="canonical" href="https://s2i-mkdocs-example.docs.cern.ch/Lezione10-11/Lezione1011/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.3">
    
    
      
        <title>Lezione 10 e 11 - Lab TNDS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/fonts.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lezione-10-e-11-metodi-montecarlo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Lab TNDS" class="md-header__button md-logo" aria-label="Lab TNDS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lab TNDS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lezione 10 e 11
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://gitlab.cern.ch/authoring/documentation/s2i-mkdocs-example" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitLab
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Lab TNDS" class="md-nav__button md-logo" aria-label="Lab TNDS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Lab TNDS
  </label>
  
    <div class="md-nav__source">
      <a href="https://gitlab.cern.ch/authoring/documentation/s2i-mkdocs-example" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitLab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione1/Lezione1/" class="md-nav__link">
        Lezione 1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione2/Lezione2/" class="md-nav__link">
        Lezione 2
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione3/Lezione3/" class="md-nav__link">
        Lezione 3
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione4/Lezione4/" class="md-nav__link">
        Lezione 4
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione5/Lezione5/" class="md-nav__link">
        Lezione 5
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione6/lezione6/" class="md-nav__link">
        Lezione 6
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione7/Lezione7/" class="md-nav__link">
        Lezione 7
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione8/Lezione8/" class="md-nav__link">
        Lezione 8 e 9
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Lezione 10 e 11
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Lezione 10 e 11
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#esercizio-100-generatore-di-numeri-casuali-da-consegnare" class="md-nav__link">
    ESERCIZIO 10.0 - Generatore di numeri casuali (da consegnare):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-101-verifica-del-teorema-del-limite-centrale-da-consegnare" class="md-nav__link">
    ESERCIZIO 10.1 - Verifica del Teorema del Limite Centrale (da consegnare):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-102-calcolo-di-integrali-con-metodi-montecarlo-da-consegnare" class="md-nav__link">
    ESERCIZIO 10.2 - Calcolo di integrali con metodi MonteCarlo (da consegnare):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-103-calcolo-di-integrali-multidimensionali-con-metodi-montecarlo-facoltativo" class="md-nav__link">
    ESERCIZIO 10.3 - Calcolo di integrali multidimensionali con metodi MonteCarlo (facoltativo):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-104-errore-nel-caso-di-integrali-multimensionali-facoltativo" class="md-nav__link">
    ESERCIZIO 10.4 - Errore nel caso di integrali multimensionali (facoltativo) :
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Lezione12/Lezione12/" class="md-nav__link">
        Lezione 12
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Survival guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Survival guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Survival guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Survival/unix/" class="md-nav__link">
        Principali comandi UNIX
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Survival/root/" class="md-nav__link">
        Principali oggetti di ROOT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#esercizio-100-generatore-di-numeri-casuali-da-consegnare" class="md-nav__link">
    ESERCIZIO 10.0 - Generatore di numeri casuali (da consegnare):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-101-verifica-del-teorema-del-limite-centrale-da-consegnare" class="md-nav__link">
    ESERCIZIO 10.1 - Verifica del Teorema del Limite Centrale (da consegnare):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-102-calcolo-di-integrali-con-metodi-montecarlo-da-consegnare" class="md-nav__link">
    ESERCIZIO 10.2 - Calcolo di integrali con metodi MonteCarlo (da consegnare):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-103-calcolo-di-integrali-multidimensionali-con-metodi-montecarlo-facoltativo" class="md-nav__link">
    ESERCIZIO 10.3 - Calcolo di integrali multidimensionali con metodi MonteCarlo (facoltativo):
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esercizio-104-errore-nel-caso-di-integrali-multimensionali-facoltativo" class="md-nav__link">
    ESERCIZIO 10.4 - Errore nel caso di integrali multimensionali (facoltativo) :
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://gitlab.cern.ch/authoring/documentation/s2i-mkdocs-example/blob/master/docs/Lezione10-11/Lezione1011.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<!-- può da più  avrà è  -->
<h1 id="lezione-10-e-11-metodi-montecarlo">Lezione 10 e 11 : metodi Montecarlo</h1>
<p>In questa lezione proveremo a familiarizzare con l'utilizzo di tecniche numeriche basate su numeri casuali.
Per prima cosa impareremo a costruire un generatore di numeri casuali. Lo utilizzeremo quindi per generare numeri che seguano diverse distribuzioni di probabilità (uniforme, esponenziale e Gaussiana). Come applicazione utilizzeremo la generazione di numeri casuali per calcolare numericamente integrali mono e multi-dimensionali. Nella prossima lezione poi utilizzeremo un generatore di numeri casuali per simulare il comportamento di un apparato sperimentale.</p>
<h2 id="esercizio-100-generatore-di-numeri-casuali-da-consegnare">ESERCIZIO 10.0 - Generatore di numeri casuali (da consegnare):</h2>
<p>In questo esercizio proveremo a costruire un generatore di numeri casuali e a studiarne il comportamento. Scriveremo un programma che produca quattro istogrammi contenenti ciascuno 10000 numeri pseudo-casuali estratti da :</p>
<ul>
<li>una distribuzione uniforme tra 5 e 10.</li>
<li>una distribuzione esponenziale tra 0 e <script type="math/tex">+\infty</script> con costante <script type="math/tex">\labmda</script>=1.</li>
<li>una distribuzione gaussiana centrata in 1 e larghezza 1 con il metodo di Box-Muller.</li>
<li>una distribuzione gaussiana centrata in 1 e larghezza 1 con il metodo accept-reject. </li>
</ul>
<p>Per risolvere questo esercizio si può seguire lo schema seguente:</p>
<ol>
<li>Scrivere una classe opportuna <code>RandomGen</code> per la generazione di numeri casuali. La classe dovrà avere un costruttore che accetti un <em>seed</em> di input e si faccia carico di inizializzare i parametri del generatore ai valori nominali. La classe dovrà inoltre contenere un metodo che implementi un generatore lineare congruenziale di base e tutti i metodi necessari per le distribuzioni richieste.</li>
<li>Preparare un semplice main per provare le funzionalità della classe <code>RandomGen</code> producendo quattro istogrammi per le distribuzioni indicate sopra.</li>
</ol>
<details>
<p><summary>Header file della classe RandomGen:: </summary></p>
<p><div class="highlight"><pre><span></span><code><span class="cp">#ifndef __RANDOMGEN_H__</span>
<span class="cp">#define __RANDOMGEN_H__</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RandomGen</span><span class="w"> </span><span class="p">{</span>

<span class="k">public</span><span class="o">:</span>

<span class="w">  </span><span class="n">RandomGen</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">);</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetA</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">m_a</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetC</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">m_c</span><span class="o">=</span><span class="n">c</span><span class="p">;}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetM</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">m_m</span><span class="o">=</span><span class="n">m</span><span class="p">;}</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="nf">Rand</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w">                                  </span><span class="c1">// distribuzione uniforme tra 0 e 1</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="nf">Unif</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xmin</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">xmax</span><span class="p">);</span><span class="w">           </span><span class="c1">// distribuzione uniforme tra xmin e xmax</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="nf">Exp</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">lambda</span><span class="p">);</span><span class="w">                       </span><span class="c1">// distribuzione esponenziale con costante lambda</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="nf">Gaus</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigma</span><span class="p">);</span><span class="w">          </span><span class="c1">// distribuzione gaussiana (Box-Muller)</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="nf">GausAR</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// distribuzione gaussiana (Accept-Reject)</span>

<span class="w"> </span><span class="k">private</span><span class="o">:</span>

<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_a</span><span class="p">,</span><span class="w"> </span><span class="n">m_c</span><span class="p">,</span><span class="w"> </span><span class="n">m_m</span><span class="p">;</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_seed</span><span class="p">;</span>

<span class="p">};</span>

<span class="cp">#endif</span>
</code></pre></div>
Il costruttore deve accettare un `unsigned int`` come <em>seed</em> di input e farsi carico di inizializzare i parametri del generatore ai valori nominali 
* m_a = 1664525
* m_c = 1013904223 
* m_m = <script type="math/tex">2^{31}</script>.</p>
</details>
<details>
<p><summary> Main per il test del generatore RandomGen: </summary></p>
<p>Un possibile <code>main</code> per provare il generatore appena costruito è indicato di seguito :</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TApplication.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TCanvas.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TH1F.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TAxis.h&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;RandomGen.h&quot;</span><span class="c1"> </span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="n">TApplication</span><span class="w"> </span><span class="n">app</span><span class="p">(</span><span class="s">&quot;app&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

<span class="w">  </span><span class="n">RandomGen</span><span class="w"> </span><span class="n">myGen</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">nmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span>

<span class="w">  </span><span class="n">TH1F</span><span class="w"> </span><span class="n">unif</span><span class="p">(</span><span class="s">&quot;Uniforme&quot;</span><span class="p">,</span><span class="s">&quot;Uniforme&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nmax</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">unif</span><span class="p">.</span><span class="n">Fill</span><span class="p">(</span><span class="w"> </span><span class="n">myGen</span><span class="p">.</span><span class="n">Unif</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">  </span>

<span class="w">    </span><span class="c1">// aggiungere le altre distribuzioni</span>

<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">TCanvas</span><span class="w"> </span><span class="n">can2</span><span class="p">(</span><span class="s">&quot;Uniforme&quot;</span><span class="p">,</span><span class="s">&quot;Uniforme&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">  </span><span class="n">can2</span><span class="p">.</span><span class="n">cd</span><span class="p">();</span>
<span class="w">  </span><span class="n">unif</span><span class="p">.</span><span class="n">GetXaxis</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&quot;x [AU]&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">unif</span><span class="p">.</span><span class="n">GetYaxis</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&quot;N&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">unif</span><span class="p">.</span><span class="n">Draw</span><span class="p">();</span>

<span class="w">  </span><span class="n">app</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>

<span class="p">}</span>
</code></pre></div>
</details>
<p>Alcuni suggerimenti qui sotto :</p>
<details class="tip">
<summary>Generatore Lineare congruenziale</summary>
<p>I generatori lineari congruenziali generano una sequenza di interi pseudo-casuali utilizzando la sequente formula:
<script type="math/tex; mode=display">n_{i} = mod ( a \, n_{i-1} + c, m)</script>
Quindi è necessario tenere in memoria il valore del numero intero generato al passaggio precedente. Alla prima iterazione <script type="math/tex">n_{0} = seed</script>
</p>
<p>Per ottenere un numero floating point uniformemente distribuito tra 0 e 1 (con 1 escluso) è sufficiente richiedere:
<script type="math/tex; mode=display">d_{i} = n_{i}/m</script>
</p>
<p>Ricordiamo che in C++ l'operazione <code>mod</code> può essere eseguita con l'operatore <code>%</code> che ritorna il resto della divisione (intera) per cui, per esempio, 
<script type="math/tex; mode=display">7 % 5 = 2</script>.</p>
</details>
<details class="tip">
<summary>Generatore esponenziale</summary>
<p>Per generare numeri pseudo-casuali secondo la densità di probabilità esponenziale 
<script type="math/tex; mode=display">p(x) = 
\begin{cases}  
\lambda e^{- \lambda x} & (x\ge 0)  \\
0 & (x<0)
\end{cases} </script>
si può facilmente invertire la funzione cumulativa di <script type="math/tex">p(x)</script> (metodo della funzione inversa). A partire da un numero <script type="math/tex">u</script> estratto secondo la distribuzione uniforme tra 0 e 1, il numero
<script type="math/tex; mode=display">x = - \frac{1}{\lambda} ln (1-u) </script>
è distribuito proprio come la distribuzione esponenziale <script type="math/tex">p(x)</script>; </p>
</details>
<details class="tip">
<summary>Metodo di Box Muller</summary>
<p>Il metodo di Box-Muller ci permette di estrarre numeri secondo una densità di probabilità gaussiana sfruttando il metodo della funzione inversa bidimensionale.
Siano <script type="math/tex">x</script> e <script type="math/tex">y</script> due variabili indipendenti distribuite normalmente (Gaussiana con media 0 e sigma 1).
L'espressione della loro distribuzione di probabilità (PDF) in due dimensioni è
<script type="math/tex; mode=display">P(x,y) = \frac{1}{2} e^ {  \frac{-(x^{2}+y^{2})}{2}}  </script>
passando alle coordinate polari
<script type="math/tex; mode=display">x = r cos(\theta)</script>
<script type="math/tex; mode=display">y = r sin(\theta)</script>
si ha
<script type="math/tex; mode=display">P(r,\theta) = \frac{1}{2} e^{ \frac{ -r^{2}}{2}} </script>
se calcoliamo l'integrale di tale PDF per <script type="math/tex">r \in [0,R]</script> e <script type="math/tex">\theta \in [0,\Theta]</script> otteniamo
<script type="math/tex; mode=display">F(R,\Theta) = (1 - e^{ \frac{- R^{2}} {2} })  \frac{ \Theta } {\pi}</script>
Definendo s e t come due variabili casuali distribuite uniformemente in [0,1], abbiamo
<script type="math/tex; mode=display">R = \sqrt{(-2ln(1-s)}</script>
<script type="math/tex; mode=display">\Theta=2 \pi t</script>
per cui due variabili x e y distribuite normalmente possono essere generate a partire da una coppia s e t distribuita uniformemente in [0,1], secondo la formula
<script type="math/tex; mode=display">x = \sqrt{-2ln(1-s) } * cos(2 \pi t) </script>
<script type="math/tex; mode=display">y = \sqrt{-2ln(1-s) } * sin(2 \pi t) </script>
Se ci limitiamo per comodità a considerare solo una delle due possiamo generalizzare al caso di variabile <script type="math/tex">x</script> distribuita gaussianamente con media <script type="math/tex">\mu</script> e larghezza <script type="math/tex">\sigma</script>
<script type="math/tex; mode=display"> x = \mu + \sigma * \sqrt{-2ln(1-s) } * cos(2 \pi t)  </script>.</p>
<p>Una possibile implementazione di tale metodo:</p>
<p><div class="highlight"><pre><span></span><code><span class="kt">double</span><span class="w"> </span><span class="nf">RandomGen::Gaus</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigma</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">s</span><span class="o">=</span><span class="n">Rand</span><span class="p">();</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="o">=</span><span class="n">Rand</span><span class="p">();</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">-2.</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">M_PI</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">mean</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">sigma</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>
</code></pre></div>
Si noti che tecnicamente dati due numeri s e t possiamo generare due numeri x e y distribuiti gaussianamente. Nel nostro esempio ne consideriamo uno soltanto per comodità di scrittura codice, non certo per efficienza !</p>
</details>
<details class="tip">
<summary>Metodo Accept-Reject</summary>
<p>Il metodo accept-reject può essere utilizzato per generare numeri casuali distribuiti secondo una qualsivoglia forma funzionale. Consideriamo di voler generare numeri nell'intervallo <script type="math/tex">[a,b]</script> secondo la distribuzione <script type="math/tex">f(x)</script> in figura</p>
<p><img alt="" src="../pictures/accrej.png" /></p>
<p>Il metodo si basa sulla generazione di una coppia di numeri <script type="math/tex">x \in [a,b]</script> e <script type="math/tex">y \in [0,max]</script> dove <script type="math/tex">max</script> è un numero maggiore del massimo valore assunto da <script type="math/tex">f(x)</script> nell'intervallo <script type="math/tex">[a,b]</script>. La coppia <script type="math/tex">x,y</script> può essere facilmente generata a partire da due numeri <script type="math/tex">s</script> e <script type="math/tex">t</script> generati uniformemente in <script type="math/tex">[0,1]</script> usando le formule
<script type="math/tex; mode=display"> x = a + (b-a) \; s </script>
<script type="math/tex; mode=display"> y = max \; t </script>
Generata la coppia <script type="math/tex">x,y</script> si valuta quindi <script type="math/tex">f(x)</script> e si accetta <script type="math/tex">x</script> se <script type="math/tex">y<f(x)</script>, altrimenti si ripete la procedura. Così facendo si avrà un maggior numero di punti generati laddove <script type="math/tex">f(x)</script> assume valori più grandi. 
Potete pensare di scrivere un metodo <em>accept-reject</em> specifico per la gaussiana o pensarene uno più generale che per esempio accetti una generica <em>FunzioneBase</em> come input.</p>
</details>
<h2 id="esercizio-101-verifica-del-teorema-del-limite-centrale-da-consegnare">ESERCIZIO 10.1 - Verifica del Teorema del Limite Centrale (da consegnare):</h2>
<p>Una applicazione molto interessante dell'estrazione di numeri casuali è la verifica del teorema del limite centrale. Per fare questo possiamo generare una serie di numeri casuali uniformemente distribuiti in [0,1] e calcolare la somma eseguita su un numero N di elementi consecutivi della serie generata. Calcolare la varianza della serie di numeri generata e della serie delle somme. Verificare come questa scala con N. Si possono pensare a due versioni di questo esercizio:</p>
<ul>
<li>
<p><em>semplice</em> : passare da riga di comando il numero N di elementi da sommare. Creare due istogrammi che contengano la distribuzione dei numeri generati e la distribuzione delle somme di N elementi. Verificare come cambia la distribuzione delle somme al variare di N provando ad eseguire il codice varie volte con diversi valori di N.</p>
</li>
<li>
<p><em>completo</em> : il codice prepara le distribuzioni (istogrammi) delle somme di N elementi con N che va da 1 a 12. Per ogni N calcola la varianza della distribuzione e genera un plot finale della varianza in funzione di N. </p>
</li>
</ul>
<p>In entrambi i casi un numero di entries maggiore di 10000 dovrebbe andare bene.</p>
<details class="tip">
<summary>Il Teorema del Limite Centrale</summary>
<p>I teoremi del limite centrale sono una famiglia di teoremi di convergenza debole nell'ambito delle teoria delle probabilità. Per tutti vale l'affermazione che la distribuzione di probabilità della somma (normalizzata) di un gran numero di variabili casuali tende ad una data distribuzione regolare (attrattore), che di norma è la Gaussiana o la Lorenziana.</p>
<p>Nel nostro caso, verificheremo che la somma di N variabili aleatorie <script type="math/tex">x_{i}</script> indipendenti e identicamente distribuite con media <script type="math/tex">\mu</script> e varianza <script type="math/tex">\sigma^{2}< + \infty</script>, tende a distribuirsi come una variabile casuale gaussiana con media pari a N<script type="math/tex">\mu</script> e varianza N<script type="math/tex">\sigma^{2}</script>, al tendere di N a infinito. </p>
</details>
<details class="success">
<summary>Risultati attesi</summary>
<p>L'output del programma potrebbe essere il seguente : per prima cosa un grafico che mostri le distribuzioni delle somme
<img alt="" src="../pictures/distribuzioni.png" />
e un grafico che mostri la varianza delle distribuzioni precedenti in funzione del numero di elementi sommati
<img alt="" src="../pictures/varianza.png" /></p>
</details>
<h2 id="esercizio-102-calcolo-di-integrali-con-metodi-montecarlo-da-consegnare">ESERCIZIO 10.2 - Calcolo di integrali con metodi MonteCarlo (da consegnare):</h2>
<p>Proviamo in questo esercizio a studiare il comportamento delle tecniche MonteCarlo per il calcolo numerico di un integrale mono-dimensionale.</p>
<ol>
<li>Calcolare 10000 volte il valore dell'integrale di sin(x) tra [0,π] utilizzando il <em>metodo della media</em> con N=100 punti e fare un grafico ( istogramma ) della distribuzione dei valori ottenuti.</li>
<li>Estendere il punto precedente calcolando 10000 volte il valore dell'integrale di sin(x) tra [0,π] utilizzando il metodo della media a N punti con N pari a 500, 1000, 5000, 10000, 50000 e 100000 punti. Per ogni valore di N produrre il grafico della distribuzione dei 10000 valori ottenuti. </li>
<li>Stimare l'errore sul calcolo dell'integrale a 500, 1000, 5000, 10000, 50000, 100000 punti come deviazione standard dei 10000 valori calcolati per ogni N. Far un grafico di questo errore in funzione di N.</li>
<li>Assumendo che l'andamento dell'errore sia noto ( del tipo <script type="math/tex">k/ \sqrt{N} </script>) si determini quanti punti sono necessari per ottenere una precisione di 0.001. Si ripeta lo stesso lavoro con il <em>metodo hit-or-miss</em>. </li>
</ol>
<p>Alcune osservazioni per lo svolgimento dell'esercizio :</p>
<ul>
<li>
<p>Per il calcolo di integrali con metodi MonteCarlo si può decidere di scrivere una nuova classe dedicata o estendere la classe `Integrale`` della lezione 7. Notate che in questo caso la nuova classe avrà avere un generatore di numeri casuali come data membro. </p>
</li>
<li>
<p>poichè il calcolo degli integrali con N molto elevato potrebbe richiedere un certo tempo, diventa molto utile spezzare il <code>main</code> in due <code>main</code> separati: il primo calcola gli integrali e li salva in diversi files di testo (uno per ogni valore di N) mentre il secondo legge i files scritti dal primo e li analizza. In questo modo possiamo agevolemnte ripetere molto volte l'analisi dei dati senza dover ricalcolare ogni volta gli integrali.</p>
</li>
</ul>
<details>
<p><summary> La classe <code>IntegraleMC</code>: </summary></p>
<p>Come al solito possiamo pensare ad una interfaccia generica <code>IntegraleMC</code> dalla quale derivano le classi concrete <code>IntegratoreMedia</code> e <code>IntegratoreHoM</code></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IntegraleMC</span><span class="w"> </span><span class="p">{</span>

<span class="k">public</span><span class="o">:</span>

<span class="w">  </span><span class="n">IntegraleMC</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">seed</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">m_errore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">m_gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RandomGen</span><span class="p">(</span><span class="n">seed</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">IntegraleMC</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">delete</span><span class="w"> </span><span class="n">m_gen</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Integra</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FunzioneBase</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">inf</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sup</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">punti</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">fmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="nf">GetErrore</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">m_errore</span><span class="p">;}</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">GetN</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">m_punti</span><span class="p">;}</span>

<span class="k">protected</span><span class="o">:</span>

<span class="w">  </span><span class="n">RandomGen</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m_gen</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m_errore</span><span class="p">;</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m_punti</span><span class="p">;</span>

<span class="p">};</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IntegratoreMedia</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IntegraleMC</span><span class="w"> </span><span class="p">{</span>

<span class="k">public</span><span class="o">:</span>

<span class="w">  </span><span class="n">IntegratoreMedia</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">seed</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IntegraleMC</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">IntegratoreMedia</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">Integra</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FunzioneBase</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">inf</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sup</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">punti</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">fmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// .... </span>

<span class="w">  </span><span class="p">};</span>

<span class="p">};</span>
</code></pre></div>
<ul>
<li>notate che tra i data membri della classe compare un puntatore <code>RandomGen * m_gen</code>: nel costruttore della classe IntegraleMC il generatore viene effettivamente allocato e il suo indirizzo depositato nel puntatore <code>m_gen</code>.</li>
<li>Per salvare la struttura delle classi virtuale/concreta siamo stati costretti ad aggiungere il campo <code>fmax</code> anche ad <code>IntegratoreMedia</code> anche se non necessario. </li>
</ul>
</details>
<details>
<p><summary> Un vector di istogrammi: </summary></p>
<p>In alcuni casi può essere comodo conservare una serie di istogrammi riempiti in un ciclo. Una possibilità è quella di creare puntatori a istogrammi e conservarli in un <code>vector&lt;TH1F*&gt;</code> per un eventuale uso seguente. Un esempio è tratteggiato qui sotto in caso sia utile :</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">TH1F</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">vhistos</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cases</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">     </span><span class="c1">// ciclo sui casi da studiare</span>

<span class="w">    </span><span class="n">TH1F</span><span class="o">*</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TH1F</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">                   </span><span class="c1">// costruzione istogramma </span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="o">-&gt;</span><span class="n">Fill</span><span class="p">(...)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">// riempimento istogramma</span>

<span class="w">    </span><span class="n">vhistos</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">h</span><span class="p">);</span><span class="w">                          </span><span class="c1">// conserviamo i puntatori</span>

<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cases</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>

<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="n">vhistos</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">Draw</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// ...</span>

<span class="w">  </span><span class="p">}</span>
</code></pre></div>
</details>
<details class="tip">
<summary>Calcolo di integrali con il metodo della media</summary>
<p>Come discusso a lezione il <em>metodo della media</em> consiste nel valutare la media delle valutazioni della funzione <script type="math/tex">f(x)</script> in un set di N punti distribuiti uniformemente tra <script type="math/tex">a</script> (minimo estremo di integrazione) e <script type="math/tex">b</script> (massimo estremo integrazione). La stima dell'integrale si ottiene poi dalla seguente formula: 
<script type="math/tex; mode=display"> \int_{a}^{b} f(x) dx \simeq (b-a) \frac{ \sum_{n=1}^{N} f(x_{n})}{N} </script>
</p>
</details>
<details class="tip">
<summary>Calcolo di integrali con il metodo hit-or-miss</summary>
<p>Il <em>metodo hit-or-miss</em> si basa sulla generazione di una coppia di numeri <script type="math/tex">x \in [a,b]</script> e <script type="math/tex">y \in [0,f_{max}]</script> dove <script type="math/tex">f_{max}</script> è un numero maggiore del massimo valore assunto da <script type="math/tex">f(x)</script> nell'intervallo <script type="math/tex">[a,b]</script>. Generata la coppia <script type="math/tex">x,y</script> si incrementa un contatore <script type="math/tex">N_{tot}</script> e si valuta quindi <script type="math/tex">f(x)</script>: se <script type="math/tex">y < f(x) </script> si incrementa anche il contatore <script type="math/tex">N_{hit}</script>. La procedura viene ripetuta fino a che il numero di estrazioni è pari all'<script type="math/tex">N_{max}</script> richiesto. La stima dell'integrale si ottiene poi dalla seguente formula: 
<script type="math/tex; mode=display"> \int_{a}^{b} f(x) dx \simeq (b-a) f_{max} \frac{N_{HIT}}{N_{TOT}} </script>
</p>
</details>
<details class="success">
<summary>Risultati attesi</summary>
<ul>
<li>Le distribuzioni attese degli integrali per i diversi valori di N dovrebbero avere questo aspetto :</li>
</ul>
<p><img alt="" src="../pictures/integrali.png" /></p>
<ul>
<li>L'andamento dell'errore (deviazione standard delle distribuzioni precedenti) in funzione di N (in scala log-log):</li>
</ul>
<p><img alt="" src="../pictures/errore_loglog.png" /></p>
<p>La curva rossa rappresenta il risultato di un fit con una funzione del tipo <script type="math/tex">f(x) = k / \sqrt{N} </script>
</p>
<ul>
<li>Nel caso del metodo della media sono necessari ~ 900000 punti per ottenere un integrale con un errore di 0.001.</li>
</ul>
</details>
<h2 id="esercizio-103-calcolo-di-integrali-multidimensionali-con-metodi-montecarlo-facoltativo">ESERCIZIO 10.3 - Calcolo di integrali multidimensionali con metodi MonteCarlo (facoltativo):</h2>
<p>Provare a risolvere il seguente integrale utilizzando per esempio il metodo della media.
<script type="math/tex; mode=display"> \int_{1}^{2} \int_{1}^{2}  \left( \frac{5}{x^{2}} cos(4y) sin(7x) +10 \right) dxdy </script>
Suggerimento: si potrebbe costruire una classe <code>FunzioneScalareBase</code> astratta da cui la funzione integranda erediti. La classe `FunzioneScalareBase`` avrà un metodo virtuale puro</p>
<p><div class="highlight"><pre><span></span><code><span class="k">virtual</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">Eval</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span>
</code></pre></div>
Alla classe che calcola l'integrale si dovrà aggiungere un metodo dedicato del tipo</p>
<p><div class="highlight"><pre><span></span><code><span class="kt">double</span><span class="w"> </span><span class="nf">Media</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FunzioneScalareBase</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">inf</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">vector</span><span class="o">&amp;</span><span class="w"> </span><span class="n">sup</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">punti</span><span class="p">);</span><span class="w"> </span>
</code></pre></div>
dove <code>inf</code> e <code>sup</code> sono i vettori che rappresentano gli estremi di integrazione.</p>
<details class="success">
<summary>Risultati attesi</summary>
<p>Integrando la funzione con 100000 punti si dovrebbe ottenere un risultato <script type="math/tex">I = 10.241 +/- 0.004</script>
</p>
</details>
<h2 id="esercizio-104-errore-nel-caso-di-integrali-multimensionali-facoltativo">ESERCIZIO 10.4 - Errore nel caso di integrali multimensionali (facoltativo) :</h2>
<p>Provare a ripetere le consegne dell'esercizio 10.2 applicate all'integrale multidimensionale dell'esercizio 10.3. In questo modo si può facilmente verificare che la legge con cui scala l'errore è indipendente dalla dimensione dell'integrale.</p>
<details class="example">
<summary>Qualche approfondimento su generatori di numeri casuali in C++11</summary>
<p>Nel C++11 è stata inserita la libreria ufficiale per la generazione di numeri casuali: si veda per esempio <a href="http://www.cplusplus.com/reference/random/">qui</a>. Provate a dare un'occhiata a <a href="../Random_numbers.cpp">questo codice</a> per trovare un esempio su come utilizzare questa libreria e su come usare le librerie di ROOT ( si faccia riferimento alla <a href="https://root.cern.ch/doc/master/classTRandom.html">referenza</a> . ) </p>
</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../Lezione8/Lezione8/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lezione 8 e 9" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Lezione 8 e 9
            </div>
          </div>
        </a>
      
      
        
        <a href="../../Lezione12/Lezione12/" class="md-footer__link md-footer__link--next" aria-label="Next: Lezione 12" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Lezione 12
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>