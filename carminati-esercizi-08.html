<!DOCTYPE html>
<html  lang="it-IT"  dir="ltr">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Lezione 8: Equazioni differenziali</title>
        <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
        <link rel="apple-touch-icon-precomposed" href="images/apple-touch-icon.png">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.26.4/css/uikit.gradient.css">

        <!-- <link rel="stylesheet" href="style.css"> -->
        <link rel="stylesheet" href="https://cdn.rawgit.com/diversen/pandoc-uikit/master/style.css">
        <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />
        <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
        <!-- <script src="uikit.js"></script> -->
        <script src="https://cdn.rawgit.com/diversen/pandoc-uikit/master/uikit.js"></script>
        <!-- <script src="scripts.js"></script> -->
        <script src="https://cdn.rawgit.com/diversen/pandoc-uikit/master/scripts.js"></script>
        <!-- <script src="jquery.sticky-kit.js "></script> -->
        <script src="https://cdn.rawgit.com/diversen/pandoc-uikit/master/jquery.sticky-kit.js"></script>

        <meta name="generator" content="pandoc-uikit" />
                <meta name="author" content="Leonardo Carminati" />
                <meta name="author" content="Maurizio Tomasi" />
                        <title>Lezione 8: Equazioni differenziali</title>
        <style type="text/css">code{white-space: pre;}</style>
                        <style type="text/css">
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        </style>
                                            <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
                                            <script>document.addEventListener("DOMContentLoaded", function () {
                                             var mathElements = document.getElementsByClassName("math");
                                             var macros = [];
                                             for (var i = 0; i < mathElements.length; i++) {
                                              var texText = mathElements[i].firstChild;
                                              if (mathElements[i].tagName == "SPAN") {
                                               katex.render(texText.data, mathElements[i], {
                                                displayMode: mathElements[i].classList.contains('display'),
                                                throwOnError: false,
                                                macros: macros,
                                                fleqn: false
                                               });
                                            }}});
                                            </script>
                                            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" />
                                          <script src="./fmtinstall.js"></script>
                 
    </head>

    <body oncopy="return false" oncut="return false" onpaste="return false">


        <div class="uk-container uk-container-center uk-margin-top uk-margin-large-bottom">

                        <div class="uk-grid" data-uk-grid-margin>
                <div class="uk-width-1-1">
                    <h1 class="uk-heading-large">Lezione 8: Equazioni differenziali</h1>
                                        <h3 class="uk-heading-large">A.A. 2021−2022</p></h3>
                                                            <p class="uk-text-large">Leonardo Carminati</p>
                                        <p class="uk-text-large">Maurizio Tomasi</p>
                                    </div>
            </div>
            
            <div class="uk-grid" data-uk-grid-margin >          
                <div class="uk-width-medium-1-4">
                    <div class="uk-overflow-container" data-uk-sticky="{top:25,media: 768}">
                        <div class="uk-panel uk-panel-box menu-begin" >

                                                        <ul>
                                                        <li><a href="#esercizio-9.0">Esercizio 9.0 - Algebra vettoriale</a></li>
                                                        <li><a href="#esercizio-9.1">Esercizio 9.1 - Risoluzione tramite metodo di Eulero</a>
                                                        <ul>
                                                        <li><a href="#il-metodo-di-eulero">Il metodo di Eulero</a></li>
                                                        <li><a href="#struttura-del-programma">Struttura del programma</a></li>
                                                        <li><a href="#cosa-ci-aspettiamo">Cosa ci aspettiamo?</a></li>
                                                        <li><a href="#esercizio-9.2">Esercizio 9.2 - Risoluzione tramite Runge-Kutta (da consegnare)</a></li>
                                                        <li><a href="#il-metodo-di-runge-kutta">Il metodo di Runge-Kutta</a></li>
                                                        <li><a href="#cosa-ci-aspettiamo-1">Cosa ci aspettiamo?</a></li>
                                                        <li><a href="#errore-in-funzione-del-passo">Errore in funzione del passo</a></li>
                                                        </ul></li>
                                                        <li><a href="#esercizio-9.3">Esercizio 9.3 - Moto del pendolo (da consegnare)</a>
                                                        <ul>
                                                        <li><a href="#il-moto-del-pendolo">Il moto del pendolo</a></li>
                                                        <li><a href="#calcolo-del-periodo">Calcolo del periodo</a></li>
                                                        </ul></li>
                                                        <li><a href="#esercizio-9.4">Esercizio 9.4 - Oscillazione forzate e risonanza (da consegnare)</a>
                                                        <ul>
                                                        <li><a href="#oscillatore-armonico-con-forzante">Oscillatore armonico con forzante</a></li>
                                                        </ul></li>
                                                        <li><a href="#esercizio-9.5">Esercizio 9.5 - Moto in campo gravitazionale</a>
                                                        <ul>
                                                        <li><a href="#moto-in-campo-gravitazionale">Moto in campo gravitazionale</a></li>
                                                        </ul></li>
                                                        <li><a href="#esercizio-9.6">Esercizio 9.6 - Moto di una particella carica in un campo elettrico e magnetico uniforme</a>
                                                        <ul>
                                                        <li><a href="#moto-in-campo-elettrico-e-magnetico-uniformi">Moto in campo elettrico e magnetico uniformi</a></li>
                                                        </ul></li>
                                                        </ul>
                            
                        </div>
                    </div>
                </div>

                <div class="uk-width-medium-3-4">
<p>[La pagina con la spiegazione originale degli esercizi si trova qui: <a href="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/lezione8_2122.html">labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/lezione8_2122.html</a>.]</p>
<p>In questa lezione introdurremo alcuni metodi per la risoluzione di equazioni differenziali ordinarie. Implementeremo la risoluzione numerica di queste equazioni con i metodi di Eulero e di Runge-Kutta.</p>
<p>Per risolvere l’esercizio vedremo come è possibile definire le principali operazioni algebriche per i vector della STL. Questo ci permetterà di realizzare i metodi di integrazione di equazioni differenziali usando una notazione vettoriale, molto simile al formalismo matematico.</p>
<h1 id="esercizio-9.0">Esercizio 9.0 - Algebra vettoriale</h1>
<p>Come prima cosa, proviamo a dotare i vector della STL di tutte le funzionalità algebriche che ci possono essere utili, definendo opportunamente gli operatori <code>+</code>, <code>*</code>, <code>/</code>, <code>+=</code>. Dal momento che non possiamo modificare gli header files e i files di implementazione della classe <code>vector</code>, implementiamo questi operatori come funzioni libere in un header file apposito da includere quando necessario. Potete trovarne un esempio qui.</p>
<p>Provate a scrivere un piccolo codice di test per verificare il corretto funzionamento delle operazioni tra vettori : potreste provate a realizzare un semplice programma che scriva a video le componenti della risultate di due forze (vettori tridimensionali) e le componenti del versore della risultante.</p>
<h1 id="esercizio-9.1">Esercizio 9.1 - Risoluzione tramite metodo di Eulero</h1>
<p>Implementare un codice per la risoluzione numerica di un’equazione differenziale descrivente il moto di un oscillatore armonico tramite il metodo di Eulero. Graficare l’andamento della posizione in funzione del tempo al variare del passo di integrazione e confrontare l’errore commesso con la soluzione esatta.</p>
<p>Struttureremo la soluzione del problema in modo simile a quanto fatto nelle precedenti lezioni su ricerca degli zeri e integrazione numerica:</p>
<p><img src="http://" /></p>
<ul>
<li>Definiamo una classe astratta <code>FunzioneVettorialeBase</code> con un unico metodo <code>Eval</code>, puramente virtuale, che dato un <code>vector</code> ed un <code>double</code>, rappresentante il tempo, restituisce il valore della derivata prima nel punto e nell’istante considerati.</li>
<li>Da questa classe astratta, deriviamo una classe concreta che descriva le leggi del modo di un oscillatore armonico, permettendo di definirne la frequenza, o nel construttore o con degli opportuni metodi per leggere/definire dei parametri.</li>
<li>Definiamo una classe astratta <code>EquazioneDifferenzialeBase</code> che ha un unico metodo <code>Passo</code>, puramente virtuale, che dati il tempo <span class="math inline">t</span>, un vettore <span class="math inline">\vec x</span>, il passo di integrazione <span class="math inline">h</span> e un puntatore ad una <code>FunzioneVettorialeBase</code>, restituisca la una stima di del valore della posizione <span class="math inline">\vec x</span> al tempo <span class="math inline">t + h</span>. Avere il tempo <span class="math inline">t</span> come argomento permetterà in esercizi futuri (come ad esempio il <a href="carminati-esercizi-09.html#esercizio-9.4---oscillazione-forzate-e-risonanza-da-consegnare">9.4</a>) di avere forzanti esterne o parametri dipendenti dal tempo.</li>
<li>Da questa classe astratta, deriviamo una classe concreta che implementi il metodo di Eulero.</li>
</ul>
<p>Per testare il metodo, risolviamo l’equazione differenziale:</p>
<p><span class="math display">
\frac{\mathrm{d}}{\mathrm{d}t} \begin{pmatrix}x\\v\end{pmatrix} =
\begin{pmatrix}v\\-\omega_0^2 x\end{pmatrix},\quad x(0) = 0, \quad v(0) = 1, \quad \omega_0 = 1,
</span></p>
<p>con passi di integrazione da 0.1 a 0.001, mettendo in grafico il valore della <span class="math inline">x</span> in funzione del tempo <span class="math inline">t</span> ed anche il suo errore rispetto alla soluzione esatta del problema, che è <span class="math inline">x(t) = \sin (t)</span>. Si consiglia di svolgere l’integrazione per un certo numero di periodi, in modo da vedere se l’ampiezza di oscillazione rimane costante. Integrare fino a <span class="math inline">t = 70\,\text{s}</span> permette di vedere circa 10 periodi.</p>
<h2 id="il-metodo-di-eulero">Il metodo di Eulero</h2>
<p>Consideriamo la seconda legge della dimanica di Newton</p>
<p><span class="math display">
a = \frac{\mathrm{d}^2 x}{\mathrm{d}t^2} = \frac{F}m,
</span></p>
<p>che è un’equazione differenziale del secondo ordine che può essere ridotta ad un’equazione differenziale del prim’ordine introducendo la variabile velocità:</p>
<p><span class="math display">
\begin{aligned}
\frac{\mathrm{d} x}{\mathrm{d}t} &amp;= v,
\frac{\mathrm{d} v}{\mathrm{d}t} &amp;= \frac{F}m.
\end{aligned}
</span></p>
<p>Il metodo di Eulero consiste nel calcolare lo stato della soluzione al tempo <span class="math inline">t + h</span> dato quello ad un tempo <span class="math inline">t</span> tramite le espressioni:</p>
<p><span class="math display">
\begin{aligned}
x(t + h) &amp;= x(t) + h \cdot \dot{x}(t) = x(t) + h \cdot v,\\
v(t + h) &amp;= v(t) + h \cdot \dot{v}(t) = x(t) + h \cdot \frac{F}m.
\end{aligned}
</span></p>
<h2 id="struttura-del-programma">Struttura del programma</h2>
<p>Le classi astratte <code>FunzioneVettorialeBase</code> e <code>EquazioneDifferenzialeBase</code> contengono (almeno per ora) solo un metodo virtuale puro, rispettivamente <code>Eval</code> e <code>Passo</code>.</p>
<p>Per comodità possiamo mettere nello stesso file anche le classi concrete che, oltre ad avere l’implementazione dei metodi virtuali dovranno implementare un costruttore ed un distruttore.</p>
<p>L’header file contente le dichiarazioni delle classi è quindi:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#pragma once</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;vectorops.h&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FunzioneVettorialeBase <span class="op">{</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">virtual</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> Eval<span class="op">(</span><span class="dt">double</span> t<span class="op">,</span> <span class="at">const</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> <span class="op">&amp;</span> x<span class="op">)</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OscillatoreArmonico <span class="op">:</span> <span class="kw">public</span> FunzioneVettorialeBase <span class="op">{</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  OscillatoreArmonico<span class="op">(</span><span class="dt">double</span> omega0<span class="op">)</span> <span class="op">:</span> <span class="va">m_omega0</span><span class="op">(</span>omega0<span class="op">)</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> Eval<span class="op">(</span><span class="dt">double</span> t<span class="op">,</span> <span class="at">const</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> <span class="op">&amp;</span> x<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span><span class="op">:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> <span class="va">m_omega</span><span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EquazioneDifferenzialeBase <span class="op">{</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">virtual</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> Passo<span class="op">(</span><span class="dt">double</span> t<span class="op">,</span> <span class="at">const</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&amp;</span> x<span class="op">,</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                               <span class="dt">double</span> h<span class="op">,</span> FunzioneVettorialeBase <span class="op">*</span> f<span class="op">)</span> <span class="at">const</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="op">};</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Eulero <span class="op">:</span> <span class="kw">public</span> EquazioneDifferenzialeBase <span class="op">{</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> Passo<span class="op">(</span><span class="dt">double</span> t<span class="op">,</span> <span class="at">const</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> <span class="op">&amp;</span> x<span class="op">,</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                       <span class="dt">double</span> h<span class="op">,</span> FunzioneVettorialeBase <span class="op">*</span>f<span class="op">)</span> <span class="at">const</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>Una volta implementate le classi (l’implementazione di Eulero è semplicissima se si usano le operazioni di algebra vettoriale), un possibile programma per risolvere l’esercizio è il seguente:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;equazionidifferenziali.h&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;fmtlib.h&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;TApplication.h&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;TAxis.h&quot;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;TCanvas.h&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;TGraph.h&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main <span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span><span class="op">**</span> argv <span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(</span>argc <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      fmt<span class="op">::</span>print<span class="op">(</span>stderr<span class="op">,</span> <span class="st">&quot;Usage: </span><span class="sc">{}</span><span class="st"> &lt;stepsize&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> argv<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  TApplication myApp<span class="op">{</span><span class="st">&quot;myApp&quot;</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">};</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  Eulero myEuler<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  OscillatoreArmonico <span class="op">*</span>osc<span class="op">{</span><span class="kw">new</span> OscillatoreArmonico<span class="op">(</span><span class="dv">1</span><span class="op">)};</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> tmax<span class="op">{</span><span class="dv">70</span><span class="op">};</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> h<span class="op">{</span>atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">1</span><span class="op">])};</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> x<span class="op">{</span><span class="fl">0.</span><span class="op">,</span> <span class="fl">1.</span><span class="op">};</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> t<span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  TGraph <span class="op">*</span>myGraph<span class="op">{</span><span class="kw">new</span> TGraph<span class="op">()};</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> nstep<span class="op">{</span><span class="dt">int</span><span class="op">(</span>tmax <span class="op">/</span> h <span class="op">+</span> <span class="fl">0.5</span><span class="op">)};</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> step<span class="op">{};</span> step <span class="op">&lt;</span> nstep<span class="op">;</span> step<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      myGraph<span class="op">-&gt;</span>SetPoint<span class="op">(</span>step<span class="op">,</span> t<span class="op">,</span> x<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      x <span class="op">=</span> myEuler<span class="op">.</span>Passo<span class="op">(</span>t<span class="op">,</span> x<span class="op">,</span> h<span class="op">,</span> osc<span class="op">);</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      t <span class="op">+=</span> h<span class="op">;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  TCanvas <span class="op">*</span>c <span class="op">=</span> <span class="kw">new</span> TCanvas<span class="op">();</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  c<span class="op">-&gt;</span>cd<span class="op">();</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  string title<span class="op">{</span>fmt<span class="op">::</span>format<span class="op">(</span><span class="st">&quot;Oscillatore armonico (Eulero, h = </span><span class="sc">{}</span><span class="st">)&quot;</span><span class="op">,</span> h<span class="op">)};</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  myGraph<span class="op">-&gt;</span>SetTitle<span class="op">(</span>title<span class="op">.</span>c_str<span class="op">());</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  myGraph<span class="op">-&gt;</span>GetXaxis<span class="op">()-&gt;</span>SetTitle<span class="op">(</span><span class="st">&quot;Tempo [s]1&quot;</span><span class="op">);</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  myGraph<span class="op">-&gt;</span>GetYaxis<span class="op">()-&gt;</span>SetTitle<span class="op">(</span><span class="st">&quot;Posizione x [m]&quot;</span><span class="op">);</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  myGraph<span class="op">-&gt;</span>Draw<span class="op">(</span><span class="st">&quot;AL&quot;</span><span class="op">);</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  myApp<span class="op">.</span>Run<span class="op">();</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Si riveda il solito esempio (<a href="./codici/test_tgraph.cpp">qui</a>) per l’uso dei <code>TGraph</code> di ROOT.</p>
<h2 id="cosa-ci-aspettiamo">Cosa ci aspettiamo?</h2>
<p>Il metodo di Eulero non è molto preciso; in effetti, con un passo di integrazione modesto si vede come esso possa risultare instabile, mostrando oscillazioni la cui ampiezza varia con il tempo. La figura sotto mostra l’andamento di <span class="math inline">x(t)</span> con un passo di integrazione di 0.1 s:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/armonico0.1_eulero.png" /></p>
<p>Per avere qualcosa di anche solo visivamente accettabile, bisogna andare a passi di almeno 0.0002 s:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/armonico0.0002_eulero.png" /></p>
<p><strong>Caccia all’errore</strong>: presentare due grafici come questi all’esame comporterebbe bocciatura immediata. Perché? (<em>Suggerimento: nel preparare i grafici per la presentazione ci si deve sempre ricordare di specificare cosa stiamo rappresentando sugli assi!</em>)</p>
<p>La figura seguente riporta l’errore accumulato dopo 70 s di integrazione per diversi valori del passo:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/errore_eulero.png" /></p>
<p>Si noti come la pendenza della curva sia 1 in una scala log-log, mostrando come l’errore ottenuto sia proporzionale al passo <span class="math inline">h</span>.</p>
<h2 id="esercizio-9.2">Esercizio 9.2 - Risoluzione tramite Runge-Kutta (da consegnare)</h2>
<p>Ripetere l’esercizio 9.1 con il metodo di risoluzione di equazioni differenziali di Runge-Kutta (del quarto ordine) e confrontare quindi in condizioni analoghe (<span class="math inline">t</span> massimo e <span class="math inline">h</span>) la stabilità dei due metodi.</p>
<p>Per svolgere l’esercizio, basterà realizzare una nuova classe concreta a partire da <code>EquazioneDifferenzialeBase</code>.</p>
<h2 id="il-metodo-di-runge-kutta">Il metodo di Runge-Kutta</h2>
<p>Il noto metodo di Runge-Kutta è un metodo del quarto ordine ed utilizza la seguente determinazione dell’incremento:</p>
<p><span class="math display">
\begin{aligned}
k_1 &amp;= \dot{x}(t, x),\\
k_2 &amp;= \dot{x}\left(t + h / 2, x + k_1 \cdot \frac{h}2\right),\\
k_3 &amp;= \dot{x}\left(t + h / 2, x + k_2 \cdot \frac{h}2\right),\\
k_4 &amp;= \dot{x}\left(t + h, x + k_3 \cdot h\right),\\
x(t+h) &amp;= x(t) + (k_1 + 2k_2 + 2k_3 + k_4)\frac{h}6.
\end{aligned}
</span></p>
<h2 id="cosa-ci-aspettiamo-1">Cosa ci aspettiamo?</h2>
<p>Il metodo di Runge-Kutte del quarto ordine è molto più preciso del metodo di Eulero: infatti produce oscillazioni molto stabili anche con un passo di integrazione di 0.1 s:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/armonico0.1_RK4.png" /></p>
<p>La figura seguente riporta l’errore accumulato dopo 70 s di integrazione per diversi valori del passo:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/errore_RK4.png" /></p>
<h2 id="errore-in-funzione-del-passo">Errore in funzione del passo</h2>
<p>Si noti come la pendenza della curva nella sua parte iniziale sia 4 in una scala log-log, mostrando come l’errore ottenuto sia proporzionale a <span class="math inline">h^4</span>.</p>
<p>Quando l’errore di troncamento del metodo diventa minore degli errori di arrotondamento della macchina si vede che non c’è più alcun miglioramento nel ridurre il passo, anzi, il maggior numero di calcoli richiesto risulta in un peggioramento globale dell’errore.</p>
<h1 id="esercizio-9.3">Esercizio 9.3 - Moto del pendolo (da consegnare)</h1>
<p>Implementare la risoluzione dell’equazione del pendolo usando i metodi precedentemente implementati. Fare quindi un grafico del periodo di oscillazione e verificare che per angoli grandi le oscillazioni non sono più isocrone.</p>
<h2 id="il-moto-del-pendolo">Il moto del pendolo</h2>
<p>L’equazione del pendolo è data dalla relazione</p>
<p><span class="math display">
\frac{\mathrm{d}^2\theta}{\mathrm{d}t^2} = -\frac{g}{l}\sin\theta,
</span></p>
<p>dove <span class="math inline">g = 9.8\,\text{m/s}^2</span> è l’accellerazione di gravità sulla superficie terreste, mentre <span class="math inline">l</span> è la lunghezza del pendolo.</p>
<p>L’equazione differenziale si può approssimare con quella di un oscillatore armonico per piccole oscillazioni, <span class="math inline">\sin\theta\sim\theta</span>. In tal caso, le oscillazioni risultano isocrone, cioè con periodo indipendente dall’ampiezza delle oscillazioni.</p>
<p>Questa però è solo un’approssimazione, e per grandi oscillazioni bisogna usare l’equazione esatta. Essendo il moto non più armonico, il periodo di oscillazione dipende dall’ampiezza della stessa. La figura illustra il periodo al variare dell’ampiezza per un pendolo con <span class="math inline">l = 1\,\text{m}</span>:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/periodo_pendoloreale.png" /></p>
<p>Si noti come per piccole oscillazioni il periodo sia effettivamente quello atteso dall’approssimazione dell’oscillatore armonico:</p>
<p><span class="math display">
T = \frac{2\pi}{\sqrt{\frac{g}l}} \approx 2.007\,\text{s},
</span> ma aumenti significativamente per grandi ampiezze.</p>
<h2 id="calcolo-del-periodo">Calcolo del periodo</h2>
<p>In questo caso l’integrazione numerica dell’equazione differenziale non si può effettuare per un tempo predefinito, ma deve essere portata avanti fino a quando non si raggiunge una condizione compatibile con l’aver terminato l’oscillazione. Una possibile soluzione consiste in:</p>
<ol>
<li>dare come condizioni iniziali un valore di <span class="math inline">\theta</span> pari all’ampiezza di oscillazione e velocità angolare iniziale nulla;</li>
<li>portare avanti l’integrazione fino a quando non si nota un cambiamento di segno della velocità angolare;</li>
<li>siccome possiamo calcolare la velocità solo con granularità pari al passo di integrazione, possiamo stimare il passaggio dallo zero interpolando linearmente tra i due ultimi valori della velocità e calcolando quando la retta ottenuta passa per lo zero;</li>
<li>il tempo così calcolato corrisponde al semiperiodo dell’oscillazione.</li>
</ol>
<p>Un esempio di pseudo-codice che implementa questo algoritmo è:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// condizioni iniziali</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> t<span class="op">{};</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>SetComponent<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="op">-</span>A<span class="op">);</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x<span class="op">.</span>SetComponent<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">// con le condizioni iniziali date, la velocità sarà maggiore</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">// o uguale a zero fino al punto di inversione del modo</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span><span class="op">(</span>x<span class="op">.</span>GetComponent<span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> x<span class="op">.</span>GetComponent<span class="op">(</span><span class="dv">1</span><span class="op">);</span> <span class="co">// salvo la velocità al passo precedente</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> myRK4<span class="op">.</span>Passo<span class="op">(</span>t<span class="op">,</span> x<span class="op">,</span> h<span class="op">,</span> osc<span class="op">);</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    t <span class="op">+=</span> h<span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">// calcolo del passaggio dallo zero utilizzando l&#39;interpolazione</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">// lineare tra il passo precedente (t - h, v) e quello finale</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">// (t, x.GetComponent(1))</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> t <span class="op">-</span> v <span class="op">*</span> h <span class="op">/</span> <span class="op">(</span>x<span class="op">.</span>GetComponent<span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">-</span> v<span class="op">);</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">// il periodo è due volte il semi-periodo appena calcolato</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>T <span class="op">*=</span> <span class="dv">2</span><span class="op">;</span></span></code></pre></div>
<p>N.B.: controllate che la formula per l’interpolazione sia corretta!</p>
<h1 id="esercizio-9.4">Esercizio 9.4 - Oscillazione forzate e risonanza (da consegnare)</h1>
<p>Implementare la risoluzione dell’equazione di un oscillatore armonico smorzato con forzante. Fare quindi un grafico della soluzione stazionaria in funzione della frequenza dell’oscillatore, ricostruendo la curva di risonanza.</p>
<h2 id="oscillatore-armonico-con-forzante">Oscillatore armonico con forzante</h2>
<p>L’equazione dell’oscillatore armonico smorzato con forzante è data dalla relazione</p>
<p><span class="math display">
\frac{\mathrm{d}^2x}{\mathrm{d}t^2} = -\omega_0^2 x + \alpha \dot{x}(t) + \sin(\omega t).
</span></p>
<p>Nell’esercizio proposto, utilizzare i seguenti valori iniziali: <span class="math display">
\omega_0 = 10\,\text{rad/s}, \quad \alpha = \frac1{30}\,\text{s}.
</span></p>
<p>È bene ricordare che per determinare l’ampiezza bisogna aspettare che il transiente iniziale delle oscillazioni si esaurisca. Questo avviene con una costante di tempo pari a <span class="math inline">1/\alpha</span> (ovvero, dopo un tempo <span class="math inline">1/\alpha</span> l’ampiezza di oscillazione si riduce di un fattore <span class="math inline">1/e</span>). Le seguenti figure illustrano la parte iniziale del transiente per condizioni iniziali <span class="math inline">x(0)=0</span>, <span class="math inline">\dot{x}(0) = 0</span> e diversi valori di <span class="math inline">\omega</span>:</p>
<table>
<thead>
<tr class="header">
<th>Frequenza</th>
<th>Andamento</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">5\,\text{rad/s}</span></td>
<td><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/transiente_05.png" /></td>
</tr>
<tr class="even">
<td><span class="math inline">10\,\text{rad/s}</span></td>
<td><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/transiente_10.png" /></td>
</tr>
<tr class="odd">
<td><span class="math inline">15\,\text{rad/s}</span></td>
<td><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/transiente_15.png" /></td>
</tr>
</tbody>
</table>
<p>Si consiglia quindi di integrare l’equazione differenziale per un tempo pari ad almeno dieci volte <span class="math inline">1/\alpha</span>, in modo da raggiungere una situazione in cui l’oscillazione è stabile, e poi valutare l’ampiezza. Anche in questo caso si può assumere di aver raggiunto il massimo dell’oscillazione nel momento in cui si trova un punto in cui la velocità cambia di segno.</p>
<p>Una curva di risonanza è illustrata in figura:</p>
<p><img src="http://labmaster.mi.infn.it/Laboratorio2/labTNDS/lectures_1819/figure/risonanza.png" /></p>
<h1 id="esercizio-9.5">Esercizio 9.5 - Moto in campo gravitazionale</h1>
<p>Implementare la risoluzione dell’equazione del moto di un corpo in un campo gravitazionale. Verificare, nel caso del sistema Terra-Sole, che il periodo di rivoluzione della Terra intorno al Sole sia effettivamente di un anno e che l’orbita sia periodica. Calcolare quindi il rapporto tra perielio ed afelio.</p>
<p>Provare ad aggiungere una piccola perturbazione al potenziale gravitazionale (ad esempio un termine proporzionale ad <span class="math inline">1/r^3</span> nella forza) e verificare che le orbite non sono più chiuse ma formano una rosetta.</p>
<h2 id="moto-in-campo-gravitazionale">Moto in campo gravitazionale</h2>
<p>Nell’implementare il moto di un corpo in un campo gravitazionale utilizzare le seguenti condizioni:</p>
<ul>
<li>costante gravitazionale <span class="math inline">G = 6.6742\times 10^{-11}\,\text{m}^3\,\text{kg}^{-1}\,\text{s}^{-2}</span>;</li>
<li>massa del Sole <span class="math inline">M_\odot = 1.98844\times 10^{30}\,\text{kg}</span>;</li>
<li>distanza Terra-Sole al perielio <span class="math inline">D_p = 1.47098074\times 10^{11}\,\text{m}</span>;</li>
<li>velocità al perielio <span class="math inline">v_p = 3.0287\times 10^4\,\text{m/s}</span>.</li>
</ul>
<h1 id="esercizio-9.6">Esercizio 9.6 - Moto di una particella carica in un campo elettrico e magnetico uniforme</h1>
<p>Implementare la risoluzione dell’equazione del moto di una particella carica in un campo elettrico e magnetico uniforme. Disegnare la traiettoria della particella e determinarne il diametro. Se si aggiunge un campo elettrico con componente lungo l’asse <span class="math inline">x</span> pari a <span class="math inline">E_x = 10^4\,\text{V/m}</span>, in che direzione si muove ora la particella?</p>
<h2 id="moto-in-campo-elettrico-e-magnetico-uniformi">Moto in campo elettrico e magnetico uniformi</h2>
<p>Il moto di una particella carica in un campo elettrico e magnetico uniformi risente della forza di Lorentz e pertanto è descritto dall’equazione <span class="math display">
m\ddot{x}(t) = q E + q v\times B,
</span> che si può riscrivere in forma matriciale come <span class="math display">
\frac{\mathrm{d}}{\mathrm{d}t} \begin{pmatrix}
x\\ y\\ z\\ v_x\\ v_y\\ v_z
\end{pmatrix} =
\begin{pmatrix}
0&amp; 0&amp; 0&amp; 1&amp; 0&amp; 0\\
0&amp; 0&amp; 0&amp; 0&amp; 1&amp; 0\\
0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 1\\
0&amp; 0&amp; 0&amp; 0&amp; \frac{q}m B_z&amp; -\frac{q}m B_y\\
0&amp; 0&amp; 0&amp; -\frac{q}m B_z&amp; 0&amp; \frac{q}m B_x\\
0&amp; 0&amp; 0&amp; \frac{q}m B_y&amp; -\frac{q}m B_x&amp; 0
\end{pmatrix}
\begin{pmatrix}
x\\ y\\ z\\ v_x\\ v_y\\ v_z
\end{pmatrix} +
\begin{pmatrix}
0\\ 0\\ 0\\ \frac{q}m E_x\\ \frac{q}m E_y\\ \frac{q}m E_z
\end{pmatrix}.
</span></p>
<p>Consideriamo il moto nel piano <span class="math inline">(x, y)</span> di un elettrone in un campo magnetico costante con i seguenti valori:</p>
<ul>
<li><span class="math inline">q = -1.60217653\times 10^{-19}\,\text{C}</span>;</li>
<li><span class="math inline">m = 9.1093826\times10^{-31}\,\text{kg}</span>;</li>
<li><span class="math inline">v_x(0) = 8\times10^6\,\text{m/s}</span>;</li>
<li><span class="math inline">B_z = 5\times10^{-3}\,\text{T}</span>;</li>
<li>tutte le altre componenti di campi e velocità iniziali sono nulle.</li>
</ul>
<p>Questi parametri corrispondono grosso modo all’apparato sperimentale per la misura di <span class="math inline">e/m</span> del laboratorio del II anno.</p>                    
                </div>
            </div>

            <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>
        </div>
    </body>
</html>
